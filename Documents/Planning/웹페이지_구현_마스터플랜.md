# 🎯 더문드립바 웹페이지 구현 마스터 플랜
## 분석 기반 전문 구현 계획 문서

**프로젝트명:** The Moon Drip BAR 웹페이지 기능 확대
**작성일:** 2025-10-24
**버전:** 1.0
**상태:** 계획 단계

---

## 📑 목차
1. [Constitution (원칙)](#1-constitution-원칙)
2. [Specify (명세)](#2-specify-명세)
3. [Clarify (명확화)](#3-clarify-명확화)
4. [Plan (계획)](#4-plan-기술-스택--아키텍처)
5. [Tasks (작업 분해)](#5-tasks-작업-분해)
6. [Implement (구현)](#6-implement-자동-코드-생성)
7. [Analyze (검증)](#7-analyze-검증)

---

## 1. CONSTITUTION (원칙)

### 핵심 기본 원칙

```
┌─────────────────────────────────────────────────────────┐
│  1. 로스팅 전문가 중심 설계                              │
│     → 기술자가 아닌 점주/관리자 중심의 직관적 UI         │
│                                                           │
│  2. 현실 데이터 기반                                      │
│     → 13종 원두, 2가지 블렌드 타입 즉시 반영             │
│     → Excel 분석 결과와 100% 일치                       │
│                                                           │
│  3. 점진적 확장성 (Progressive Enhancement)              │
│     → 필수 기능부터 시작 → 고급 분석으로 확장            │
│     → 멀티점/멀티사용자 확장 가능 구조                   │
│                                                           │
│  4. 데이터 신뢰성                                        │
│     → 로스팅 일지 = 진실의 단일 소스                      │
│     → 모든 결정이 데이터 기반                            │
│                                                           │
│  5. 최소한의 기술 부채                                    │
│     → Streamlit으로 빠른 구현 (기존 환경 활용)          │
│     → Python 생태계 최대 활용 (Pandas, Plotly)         │
│                                                           │
│  6. 운영 효율성                                          │
│     → 자동화로 수작업 최소화                             │
│     → 실시간 모니터링 & 알림                             │
└─────────────────────────────────────────────────────────┘
```

---

## 2. SPECIFY (명세)

### A. 현황 분석 (분석결과.xlsx 기반)

| 항목 | 수치 | 비고 |
|------|------|------|
| **관리 원두** | 13종 | Eth, K, Co, Gu, Cos, Br 6개국 |
| **로스팅 레벨** | 6종 | W(5), N(3), Pb, Rh, SD(2), SC |
| **블렌드 타입** | 2가지 | 풀문(4가지), 뉴문(3가지) |
| **포션 구성** | 20개 | 풀문(10), 뉴문(10) |
| **가격정책** | 2단계 | 마사이 22,000원 + 나머지 미정 |

### B. 웹페이지 필수 기능 (MVP)

#### 🏠 대시보드 (HOME)
- 핵심 지표 (판매수, 매출, 인기도)
- 실시간 모니터링 (재고, 판매 추이)
- 오늘의 블렌드 시각화
- 재고 부족 알림

#### ☕ 원두 관리 (BEANS)
- 13종 원두 목록 (필터, 정렬, 검색)
- 원두 추가/편집/삭제
- 사진 및 상세 정보 관리
- 원두별 재고 및 가격 관리

#### 🎨 블렌딩 관리 (BLENDS)
- 풀문 블렌드 (4가지) 관리
- 뉴문 블렌딩 (3가지) 관리
- 포션 비율 시각화 (파이 차트)
- 원가 자동 계산
- 판매가 추천

#### 📊 분석 (ANALYTICS)
- 판매 통계 (기간별, 블렌드별, 원두별)
- 수익 분석 (수익률, 마진)
- 고객 선호도 분석
- 시간대별 판매 추이

#### 📦 재고 관리 (INVENTORY)
- 현재 재고 현황
- 입고/사용 기록
- 최소 재고 설정 및 알림
- 재고 예측

#### 📄 보고서 (REPORTS)
- 월간 보고서 생성
- PDF/Excel 내보내기
- 분기/연간 비교 분석

#### ⚙️ 설정 (SETTINGS)
- 가격 설정 (원두, 로스팅 손실율)
- 블렌드 레시피 기본값
- 사용자 설정
- 백업/복원

### C. 주요 개선사항 (현재 앱 대비)

| 현재 (app.py) | 개선 사항 |
|---|---|
| 기본 입력 폼 | ✨ 직관적 대시보드 + 상세 분석 |
| 간단 차트 | ✨ 다양한 시각화 + 비교 분석 |
| 단순 통계 | ✨ 심화 분석 (수익률, 예측 등) |
| 없음 | ✨ 실시간 재고 알림 |
| 없음 | ✨ 블렌딩 원가 자동 계산 |
| 없음 | ✨ 월간/분기 보고서 생성 |
| 없음 | ✨ 다중 사용자 권한 관리 |
| 없음 | ✨ 성능 최적화 (캐싱, 페이지네이션) |

---

## 3. CLARIFY (명확화)

### 데이터 기반 가정사항

✅ **기술:** Streamlit + SQLite (기존 환경 최대 활용)
✅ **목표:** 현재 app.py 대폭 개선 (기능 2배 이상)
✅ **데이터:** 분석 결과의 13종 원두, 2가지 블렌드 즉시 반영
✅ **기간:** 3주 이내 완성
✅ **배포:** 로컬 + 클라우드 확장 가능

### 향후 확인 필요사항

```
1️⃣  사용자 역할 관리
   ○ 단일 사용자 (점주만)
   ○ 다중 역할 (점주, 로스팅담당자, 직원)

2️⃣  판매 기록 관리
   ○ 필요 없음
   ○ 간단한 판매 기록
   ○ 상세한 판매 시스템

3️⃣  외부 연동
   ○ 로컬만 사용
   ○ 클라우드 백업
   ○ POS 연동
```

---

## 4. PLAN (기술 스택 & 아키텍처)

### 기술 스택

```yaml
Frontend/Backend:
  Framework: Streamlit 1.38.0
  Language: Python 3.12.3

Database:
  Engine: SQLite 3
  ORM: SQLAlchemy (신규)

Data Processing:
  Pandas: 데이터 처리
  NumPy: 수치 계산

Visualization:
  Plotly: 대시보드 차트
  Streamlit Charts: 기본 차트

Excel Integration:
  openpyxl: Excel 읽기/쓰기
  Pandas Excel: 동기화
```

### 폴더 구조

```
TheMoon_Project/
├── app/
│   ├── app.py                    # 메인 Streamlit 앱
│   ├── pages/                    # 멀티페이지
│   │   ├── 1_대시보드.py
│   │   ├── 2_원두관리.py
│   │   ├── 3_블렌딩관리.py
│   │   ├── 4_분석.py
│   │   ├── 5_재고관리.py
│   │   ├── 6_보고서.py
│   │   └── 7_설정.py
│   ├── components/               # 재사용 컴포넌트
│   │   ├── dashboard.py
│   │   ├── charts.py
│   │   ├── tables.py
│   │   └── forms.py
│   ├── models/                   # 데이터 모델
│   │   ├── database.py
│   │   ├── bean.py
│   │   ├── blend.py
│   │   ├── inventory.py
│   │   └── transaction.py
│   ├── services/                 # 비즈니스 로직
│   │   ├── bean_service.py
│   │   ├── blend_service.py
│   │   ├── inventory_service.py
│   │   ├── analytics_service.py
│   │   ├── report_service.py
│   │   └── excel_sync.py
│   ├── utils/                    # 유틸리티
│   │   ├── constants.py
│   │   ├── helpers.py
│   │   ├── validators.py
│   │   └── formatters.py
│   ├── assets/                   # 이미지, 스타일
│   │   ├── images/
│   │   └── styles.css
│   └── test_data.py
├── Data/
│   ├── roasting_data.db
│   ├── backups/
│   └── exports/
└── Documents/
    ├── 웹페이지_구현_마스터플랜.md
    ├── DB_스키마.md
    └── 사용설명서.md
```

### 데이터베이스 스키마 (간략)

```sql
-- 원두
CREATE TABLE beans (
    id, no, country_code, name, roast_level,
    description, image_url, price_per_kg, status
);

-- 블렌드
CREATE TABLE blends (
    id, name, type, description, status
);

-- 블렌드 구성
CREATE TABLE blend_recipes (
    id, blend_id, bean_id, portion_count, ratio
);

-- 재고
CREATE TABLE inventory (
    id, bean_id, quantity_kg, min_quantity
);

-- 거래 (판매/사용)
CREATE TABLE transactions (
    id, blend_id, type, quantity, price, created_at
);
```

---

## 5. TASKS (작업 분해)

### Phase 1: 기초 구축 (3-4일)

**Task 1-1: DB 스키마 설계**
- [ ] 현재 DB 구조 분석
- [ ] 신규 스키마 설계
- [ ] 마이그레이션 스크립트 작성
- [ ] 데이터 이전 및 검증

**Task 1-2: 프로젝트 구조**
- [ ] 폴더 구조 생성
- [ ] requirements.txt 업데이트
- [ ] Streamlit 설정
- [ ] 로깅 설정

**Task 1-3: 서비스 레이어**
- [ ] BeanService
- [ ] BlendService
- [ ] InventoryService
- [ ] AnalyticsService

### Phase 2: 핵심 페이지 (5-6일)

- [ ] 메인 앱 재작성
- [ ] 대시보드 페이지
- [ ] 원두 관리 페이지
- [ ] 블렌딩 관리 페이지
- [ ] 분석 페이지
- [ ] 재고 관리 페이지

### Phase 3: 고급 기능 (4-5일)

- [ ] 보고서 생성 (PDF/Excel)
- [ ] 설정 페이지
- [ ] Excel 동기화
- [ ] 알림 시스템

### Phase 4: 테스트 & 배포 (2-3일)

- [ ] 기능 검증
- [ ] 성능 최적화
- [ ] 사용성 테스트
- [ ] 문서화 및 배포

---

## 6. IMPLEMENT (자동 코드 생성)

### 구현 순서

#### Phase 1: 기초 (일자: TBD)
1. `app/models/database.py` - DB 초기화, SQLAlchemy 세팅
2. `app/models/bean.py`, `blend.py`, `inventory.py` - ORM 모델
3. `app/services/` - CRUD 서비스 레이어
4. `app/utils/constants.py` - 원두 13종, 블렌드 2종 정의

#### Phase 2: 핵심 (일자: TBD)
1. `app/app.py` - 메인 Streamlit 앱 (멀티페이지)
2. `app/pages/1_대시보드.py` - 대시보드
3. `app/pages/2_원두관리.py` - 원두 CRUD
4. `app/pages/3_블렌딩관리.py` - 블렌드 관리
5. `app/pages/4_분석.py` - 통계 분석
6. `app/pages/5_재고관리.py` - 재고 추적

#### Phase 3: 고급 (일자: TBD)
1. `app/pages/6_보고서.py` - 보고서 생성
2. `app/pages/7_설정.py` - 설정 관리
3. `app/services/excel_sync.py` - Excel 동기화

---

## 7. ANALYZE (검증)

### 기능 검증 체크리스트

#### 대시보드
- [ ] 핵심 지표 4개 이상 표시
- [ ] 실시간 차트 동작
- [ ] 재고 알림 정상 작동

#### 원두 관리
- [ ] 13종 원두 모두 등록
- [ ] 필터링/정렬/검색 정상
- [ ] CRUD 기능 정상

#### 블렌딩 관리
- [ ] 풀문 블렌드 4가지 표시
- [ ] 뉴문 블렌딩 3가지 표시
- [ ] 포션 비율 정확 (40%, 40%, 10%, 10% 등)
- [ ] 원가 자동 계산 정확

#### 분석
- [ ] 차트 데이터 정확
- [ ] 기간 필터링 작동
- [ ] 통계값 검증 (합계 일치)

#### 재고 관리
- [ ] 재고량 정확
- [ ] 알림 임계값 설정 가능
- [ ] 기록 정확성

#### 데이터 검증
- [ ] DB 무결성 (Foreign Key)
- [ ] Excel↔DB 동기화 일치
- [ ] 분석결과와 통계 일치

#### 성능 검증
- [ ] 페이지 로딩 < 2초
- [ ] 차트 렌더링 < 1초
- [ ] DB 쿼리 < 500ms

#### 사용성 검증
- [ ] 직관적 사용 가능
- [ ] 명확한 에러 메시지
- [ ] 반응형 디자인

---

## 📊 예상 결과물

```
✅ 완전한 웹 기반 로스팅 관리 시스템
✅ 실시간 대시보드 & 분석
✅ 모바일 호환 반응형 디자인
✅ Excel 데이터 자동 동기화
✅ 확장 가능한 아키텍처
✅ 전문가용 보고서 생성
✅ 자동화 & 알림 시스템
```

---

## 🎯 타임라인

| Phase | 기간 | 작업 |
|-------|------|------|
| 1 | 3-4일 | 기초 구축 (DB, 서비스) |
| 2 | 5-6일 | 핵심 페이지 (6개) |
| 3 | 4-5일 | 고급 기능 (보고서, Excel) |
| 4 | 2-3일 | 테스트 & 배포 |
| **합계** | **14-18일** | **완성** |

---

## ✅ 최종 체크리스트

```
코드 생성:
□ Phase 1 (기초) - database, models, services
□ Phase 2 (핵심) - 6개 페이지
□ Phase 3 (고급) - reports, settings, excel_sync
□ Phase 4 (테스트) - 검증 및 최적화

배포:
□ requirements.txt 최신화
□ 문서화 완료
□ 운영 가이드 작성

최종:
□ 명세 ↔ 코드 검증 100% 일치
□ 성능 기준 충족
□ 사용성 테스트 통과
```

---

**문서 버전:** 1.0
**최종 수정:** 2025-10-24
**상태:** ✅ 승인 대기

